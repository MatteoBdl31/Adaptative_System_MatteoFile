<div class="demo-panel panel-card">
    <div class="panel-header">
        <div>
            <h2>{{ result.scenario.title }}</h2>
            <p>{{ result.scenario.description }}</p>
        </div>
        <span class="badge">{{ result.active_rules|length }} rules</span>
    </div>

    <div class="context-pill-group">
        {% for key, value in result.context.items() %}
            {% if key == 'time_available' %}
                {% set days = (value // (24 * 60)) %}
                {% set hours = ((value % (24 * 60)) // 60) %}
                <span class="context-pill">
                    Time Available: <strong>{% if days > 0 %}{{ days }} day{{ 's' if days != 1 else '' }}{% endif %}{% if days > 0 and hours > 0 %} {% endif %}{% if hours > 0 %}{{ hours }} hour{{ 's' if hours != 1 else '' }}{% endif %}</strong>
                </span>
            {% else %}
                <span class="context-pill">
                    {{ key.replace('_', ' ').title() }}: <strong>{{ value }}</strong>
                </span>
            {% endif %}
        {% endfor %}
    </div>

    <div class="demo-results">
        <div class="result-section">
            <div class="section-header">
                <h3>üéØ Recommended ({{ result.exact|length }})</h3>
                <small>Perfect matches for this situation</small>
            </div>
            {% if result.exact %}
            <div class="trail-list modern">
                {% for trail in result.exact %}
                <div class="trail-card modern recommended">
                    <div class="card-heading">
                        <strong>{{ trail.name }}</strong>
                        <span class="pill difficulty-{{ 'easy' if trail.difficulty <= 3 else 'medium' if trail.difficulty <= 6 else 'hard' }}">
                            {% if trail.difficulty <= 3 %}Easy{% elif trail.difficulty <= 6 %}Medium{% else %}Hard{% endif %}
                        </span>
                    </div>
                    <div class="trail-stats">
                        <span>{{ trail.distance or '‚Äî' }} km</span>
                        <span>{{ trail.duration|format_duration }}</span>
                        <span>{{ trail.elevation_gain or '‚Äî' }} m</span>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
                <p class="empty">No direct matches for this scenario.</p>
            {% endif %}
        </div>

        <div class="result-section">
            <div class="section-header">
                <h3>‚ú® Additional suggestions ({{ result.suggestions|length }})</h3>
                <small>High potential even if slightly off the brief</small>
            </div>
            {% if result.suggestions %}
            <div class="trail-list subtle modern">
                {% for trail in result.suggestions %}
                <div class="trail-card modern suggested">
                    <div class="card-heading">
                        <strong>{{ trail.name }}</strong>
                        <span class="relevance-badge">{{ "%.0f"|format(trail.relevance_percentage|default(0.0)) }}%</span>
                    </div>
                    <div class="trail-stats">
                        <span>{{ trail.distance or '‚Äî' }} km</span>
                        <span>{{ trail.duration|format_duration }}</span>
                        <span>{{ trail.elevation_gain or '‚Äî' }} m</span>
                    </div>
                    {% if trail.unmatched_criteria %}
                    <div class="unmatched-criteria">
                        <small class="unmatched-label">Missing criteria:</small>
                        <ul class="unmatched-list">
                            {% for criteria in trail.unmatched_criteria %}
                            <li class="unmatched-item">{{ criteria }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
                <p class="empty">No additional suggestions for this scenario.</p>
            {% endif %}
        </div>

        <div class="result-section">
            <div class="section-header">
                <h3>üìê Display adjustments</h3>
                <small>Tunings applied to the UI</small>
            </div>
            <ul class="display-settings">
                {% for key, value in result.display.items() %}
                    <li><code>{{ key }}</code> ‚Üí <strong>{{ value }}</strong></li>
                {% endfor %}
            </ul>
        </div>

        <div class="result-section">
            <div class="section-header">
                <h3>üß† Matching rules</h3>
            </div>
            <ul class="rules-list">
                {% for rule in result.active_rules %}
                    <li>
                        <strong>{{ rule.description or rule.condition }}</strong>
                        <span>{{ rule.condition }}</span>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>

